<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineWeb - Gesti贸n de Cines</title>
    <link rel="stylesheet" href="/css/styles.css">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Google Sign-In -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <!-- Pantalla de Login -->
    <div id="login-screen" class="screen active">
        <div class="login-container">
            <h1> CineWeb</h1>
            <p>Sistema de Gesti贸n de Cines</p>
            <div id="g_id_onload"
                 data-client_id="849177337262-3gd6ieo104cjjp29mdd8cosk6espur18.apps.googleusercontent.com"
                 data-callback="handleCredentialResponse">
            </div>
            <div class="g_id_signin" 
                 data-type="standard"
                 data-size="large"
                 data-theme="outline"
                 data-text="sign_in_with"
                 data-shape="rectangular"
                 data-logo_alignment="left">
            </div>
        </div>
    </div>

    <!-- Aplicaci贸n Principal -->
    <div id="app-screen" class="screen">
        <!-- Navegaci贸n -->
        <nav class="navbar">
            <div class="nav-content">
                <h2> CineWeb</h2>
                <div class="user-info">
                    <span id="user-name"></span>
                    <button onclick="logout()" class="btn-logout">Cerrar sesi贸n</button>
                </div>
            </div>
        </nav>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('peliculas')">Pel铆culas</button>
            <button class="tab" onclick="showTab('salas')">Salas</button>
            <button class="tab" onclick="showTab('proyecciones')">Proyecciones</button>
            <button class="tab" onclick="showTab('buscar')">Buscar Pel铆cula</button>
        </div>

        <!-- Tab: Pel铆culas -->
        <div id="tab-peliculas" class="tab-content active">
            <div class="container">
                <h2>Crear Pel铆cula</h2>
                <form id="form-pelicula" class="form" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="pelicula-titulo">T铆tulo de la pel铆cula:</label>
                        <input type="text" id="pelicula-titulo" required>
                    </div>
                    <div class="form-group">
                        <label for="pelicula-cartel">Cartel de la pel铆cula:</label>
                        <input type="file" id="pelicula-cartel" accept="image/*">
                        <small>Sube una imagen del cartel (PNG, JPG, JPEG, GIF, WEBP)</small>
                        <div id="preview-pelicula" class="image-preview"></div>
                    </div>
                    <button type="submit" class="btn-primary">
                        <span id="btn-pelicula-text">Crear Pel铆cula</span>
                        <span id="btn-pelicula-loading" style="display: none;">Subiendo imagen...</span>
                    </button>
                </form>

                <h2>Lista de Pel铆culas</h2>
                <div id="peliculas-list" class="items-list"></div>
            </div>
        </div>

        <!-- Tab: Salas -->
        <div id="tab-salas" class="tab-content">
            <div class="container">
                <h2>Crear Sala</h2>
                <form id="form-sala" class="form">
                    <div class="form-group">
                        <label for="sala-nombre">Nombre de la sala:</label>
                        <input type="text" id="sala-nombre" required>
                    </div>
                    <div class="form-group">
                        <label for="sala-direccion">Direcci贸n postal:</label>
                        <input type="text" id="sala-direccion" required placeholder="Busca una direcci贸n..." autocomplete="off">
                        <small>Escribe para ver sugerencias de direcciones</small>
                        <div id="direccion-suggestions" class="autocomplete-suggestions"></div>
                    </div>
                    <div class="form-group">
                        <label>Email del propietario:</label>
                        <input type="email" id="sala-email" readonly>
                        <small>Se usa autom谩ticamente tu email</small>
                    </div>
                    
                    <!-- Mapa de selecci贸n de ubicaci贸n -->
                    <div id="mapa-sala-container" style="display: none;">
                        <label> Ajusta la ubicaci贸n exacta (arrastra el marcador):</label>
                        <div id="mapa-sala" style="height: 400px; border-radius: 10px; margin-top: 0.5rem;"></div>
                        <small style="display: block; margin-top: 0.5rem; color: #666;">Arrastra el marcador rojo a la ubicaci贸n exacta</small>
                    </div>
                    
                    <!-- Campos ocultos para coordenadas -->
                    <input type="hidden" id="sala-latitud">
                    <input type="hidden" id="sala-longitud">
                    
                    <button type="submit" class="btn-primary">Crear Sala</button>
                </form>

                <h2>Lista de Salas</h2>
                <div id="salas-list" class="items-list"></div>
            </div>
        </div>

        <!-- Tab: Proyecciones -->
        <div id="tab-proyecciones" class="tab-content">
            <div class="container">
                <h2>Asignar Proyecci贸n</h2>
                <form id="form-proyeccion" class="form">
                    <div class="form-group">
                        <label for="proyeccion-pelicula">T铆tulo de la pel铆cula:</label>
                        <input type="text" id="proyeccion-pelicula" required list="peliculas-datalist">
                        <datalist id="peliculas-datalist"></datalist>
                    </div>
                    <div class="form-group">
                        <label for="proyeccion-sala">Nombre de la sala:</label>
                        <input type="text" id="proyeccion-sala" required list="salas-datalist">
                        <datalist id="salas-datalist"></datalist>
                    </div>
                    <div class="form-group">
                        <label for="proyeccion-fecha">Fecha y hora de proyecci贸n:</label>
                        <input type="datetime-local" id="proyeccion-fecha" required>
                    </div>
                    <button type="submit" class="btn-primary">Asignar Proyecci贸n</button>
                </form>

                <h2>Lista de Proyecciones</h2>
                <div id="proyecciones-list" class="items-list"></div>
            </div>
        </div>

        <!-- Tab: Buscar -->
        <div id="tab-buscar" class="tab-content">
            <div class="container">
                <h2>Buscar Pel铆cula</h2>
                <form id="form-buscar" class="form">
                    <div class="form-group">
                        <label for="buscar-titulo">T铆tulo de la pel铆cula:</label>
                        <input type="text" id="buscar-titulo" required list="peliculas-datalist-buscar">
                        <datalist id="peliculas-datalist-buscar"></datalist>
                    </div>
                    <button type="submit" class="btn-primary">Buscar</button>
                </form>

                <div id="resultado-busqueda" class="search-result"></div>
                
                <!-- Mapa de salas -->
                <div id="mapa-container" style="display: none;">
                    <h3> Ubicaci贸n de las salas</h3>
                    <div id="mapa" style="height: 500px; border-radius: 10px; margin-top: 1rem;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mensajes de notificaci贸n -->
    <div id="notification" class="notification"></div>

    <script src="/js/app.js"></script>
</body>
</html>
